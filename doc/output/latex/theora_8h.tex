\hypertarget{theora_8h}{}\section{src/packages/\+Allegro\+Deps.1.5.0.1/build/native/include/theora/theora.h File Reference}
\label{theora_8h}\index{src/packages/\+Allegro\+Deps.\+1.\+5.\+0.\+1/build/native/include/theora/theora.\+h@{src/packages/\+Allegro\+Deps.\+1.\+5.\+0.\+1/build/native/include/theora/theora.\+h}}
{\ttfamily \#include $<$stddef.\+h$>$}\newline
{\ttfamily \#include $<$ogg/ogg.\+h$>$}\newline
Include dependency graph for theora.\+h\+:
% FIG 0
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structyuv__buffer}{yuv\+\_\+buffer}
\item 
struct \hyperlink{structtheora__info}{theora\+\_\+info}
\item 
struct \hyperlink{structtheora__state}{theora\+\_\+state}
\item 
struct \hyperlink{structtheora__comment}{theora\+\_\+comment}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{group__oldfuncs_gaa4370e13ed3aea6441ccf69dcab2506e}{O\+C\+\_\+\+F\+A\+U\+LT}~-\/1
\item 
\#define \hyperlink{group__oldfuncs_ga43d15091b1a03a734a124e9a04d3be55}{O\+C\+\_\+\+E\+I\+N\+V\+AL}~-\/10
\item 
\#define \hyperlink{group__oldfuncs_ga38b9fa0af856d5930c534db26e2ac2d1}{O\+C\+\_\+\+D\+I\+S\+A\+B\+L\+ED}~-\/11
\item 
\#define \hyperlink{group__oldfuncs_ga809cbad2eb36be17a235a3cadfb737ba}{O\+C\+\_\+\+B\+A\+D\+H\+E\+A\+D\+ER}~-\/20
\item 
\#define \hyperlink{group__oldfuncs_ga9558d6d9eacd2273c8da27f945d725ad}{O\+C\+\_\+\+N\+O\+T\+F\+O\+R\+M\+AT}~-\/21
\item 
\#define \hyperlink{group__oldfuncs_ga4611cfd61160405721d1e2ab0ec2564b}{O\+C\+\_\+\+V\+E\+R\+S\+I\+ON}~-\/22
\item 
\#define \hyperlink{group__oldfuncs_ga895dc2597b3bf9c97bf7701c6eff5b0c}{O\+C\+\_\+\+I\+M\+PL}~-\/23
\item 
\#define \hyperlink{group__oldfuncs_ga117774c062a63dfad2a5b4d092fa2bb1}{O\+C\+\_\+\+B\+A\+D\+P\+A\+C\+K\+ET}~-\/24
\item 
\#define \hyperlink{group__oldfuncs_ga60be4dc92c933eac3542bce3ce076496}{O\+C\+\_\+\+N\+E\+W\+P\+A\+C\+K\+ET}~-\/25
\item 
\#define \hyperlink{group__oldfuncs_ga84a8d2f5080ad62b415a4e7551941cbb}{O\+C\+\_\+\+D\+U\+P\+F\+R\+A\+ME}~1
\end{DoxyCompactItemize}
\begin{Indent}\textbf{ theora\+\_\+control() codes}\par
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{group__oldfuncs_gab31f251c9319f2140d247585d30b3d07}{T\+H\+\_\+\+D\+E\+C\+C\+T\+L\+\_\+\+G\+E\+T\+\_\+\+P\+P\+L\+E\+V\+E\+L\+\_\+\+M\+AX}~(1)
\item 
\#define \hyperlink{group__oldfuncs_ga87774c35e1a755a84e2d705b38ebef0d}{T\+H\+\_\+\+D\+E\+C\+C\+T\+L\+\_\+\+S\+E\+T\+\_\+\+P\+P\+L\+E\+V\+EL}~(3)
\item 
\#define \hyperlink{group__oldfuncs_ga27e755e15b4b5604c54974b304037a49}{T\+H\+\_\+\+E\+N\+C\+C\+T\+L\+\_\+\+S\+E\+T\+\_\+\+K\+E\+Y\+F\+R\+A\+M\+E\+\_\+\+F\+R\+E\+Q\+U\+E\+N\+C\+Y\+\_\+\+F\+O\+R\+CE}~(4)
\item 
\#define \hyperlink{group__oldfuncs_ga1e870c654d35394f0d490045df04e0f5}{T\+H\+\_\+\+D\+E\+C\+C\+T\+L\+\_\+\+S\+E\+T\+\_\+\+G\+R\+A\+N\+P\+OS}~(5)
\item 
\#define \hyperlink{group__oldfuncs_ga3befcdd66678f8d27034f9c4b16d1b9c}{T\+H\+\_\+\+E\+N\+C\+C\+T\+L\+\_\+\+S\+E\+T\+\_\+\+Q\+U\+A\+N\+T\+\_\+\+P\+A\+R\+A\+MS}~(2)
\item 
\#define \hyperlink{group__oldfuncs_ga382d685a39a34d8e6ba76b00d804efd8}{T\+H\+\_\+\+E\+N\+C\+C\+T\+L\+\_\+\+S\+E\+T\+\_\+\+V\+P3\+\_\+\+C\+O\+M\+P\+A\+T\+I\+B\+LE}~(10)
\item 
\#define \hyperlink{group__oldfuncs_ga9baf5bdd206e80c78a8fd44687e89783}{T\+H\+\_\+\+E\+N\+C\+C\+T\+L\+\_\+\+G\+E\+T\+\_\+\+S\+P\+L\+E\+V\+E\+L\+\_\+\+M\+AX}~(12)
\item 
\#define \hyperlink{group__oldfuncs_gabd9fbcb6a25a77d991d3620164fe59d6}{T\+H\+\_\+\+E\+N\+C\+C\+T\+L\+\_\+\+S\+E\+T\+\_\+\+S\+P\+L\+E\+V\+EL}~(14)
\end{DoxyCompactItemize}
\end{Indent}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structtheora__comment}{theora\+\_\+comment} \hyperlink{group__oldfuncs_gaa504e8a56a4bf9c8e44f77d05aef0bb5}{theora\+\_\+comment}
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{group__oldfuncs_gaa567da4ce591f7373149ce3ef3acdac9}{theora\+\_\+colorspace} \{ \hyperlink{group__oldfuncs_ggaa567da4ce591f7373149ce3ef3acdac9abf217cf83d7d7cbf73295e6689f5cf5f}{O\+C\+\_\+\+C\+S\+\_\+\+U\+N\+S\+P\+E\+C\+I\+F\+I\+ED}, 
\hyperlink{group__oldfuncs_ggaa567da4ce591f7373149ce3ef3acdac9ab20c9851a21ab148fef0bf2c00c0a294}{O\+C\+\_\+\+C\+S\+\_\+\+I\+T\+U\+\_\+\+R\+E\+C\+\_\+470M}, 
\hyperlink{group__oldfuncs_ggaa567da4ce591f7373149ce3ef3acdac9a04f8fa2da26f9ec513f514163705666a}{O\+C\+\_\+\+C\+S\+\_\+\+I\+T\+U\+\_\+\+R\+E\+C\+\_\+470\+BG}, 
\hyperlink{group__oldfuncs_ggaa567da4ce591f7373149ce3ef3acdac9a640b572f11fa7102d434e1c605aaa186}{O\+C\+\_\+\+C\+S\+\_\+\+N\+S\+P\+A\+C\+ES}
 \}
\item 
enum \hyperlink{group__oldfuncs_gae169da05bfaaf4e964a6866552d45079}{theora\+\_\+pixelformat} \{ \hyperlink{group__oldfuncs_ggae169da05bfaaf4e964a6866552d45079a4e451af01be2645511b0e431f5225d2b}{O\+C\+\_\+\+P\+F\+\_\+420}, 
\hyperlink{group__oldfuncs_ggae169da05bfaaf4e964a6866552d45079a7d21c63341ad299766839c83ed1216eb}{O\+C\+\_\+\+P\+F\+\_\+\+R\+S\+VD}, 
\hyperlink{group__oldfuncs_ggae169da05bfaaf4e964a6866552d45079a36a88c55b7ddd5aedeac2d61d57fee5b}{O\+C\+\_\+\+P\+F\+\_\+422}, 
\hyperlink{group__oldfuncs_ggae169da05bfaaf4e964a6866552d45079a1d5c6d1b0365e06b4a87880b7825f044}{O\+C\+\_\+\+P\+F\+\_\+444}
 \}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{zconf_8h_a2c212835823e3c54a8ab6d95c652660e}{const} char $\ast$ \hyperlink{group__oldfuncs_ga5a3da8fd262a60f055f96536eec06df2}{theora\+\_\+version\+\_\+string} (\hyperlink{png_8h_ac9c84fa68bbad002983e35ce3663c686}{void})
\item 
ogg\+\_\+uint32\+\_\+t \hyperlink{group__oldfuncs_gad181f4b19d455dcc2bef2533530b84c8}{theora\+\_\+version\+\_\+number} (\hyperlink{png_8h_ac9c84fa68bbad002983e35ce3663c686}{void})
\item 
int \hyperlink{group__oldfuncs_ga0f7ad4d4b2343278cb4ba8fb2bd5109a}{theora\+\_\+encode\+\_\+init} (\hyperlink{structtheora__state}{theora\+\_\+state} $\ast$th, \hyperlink{structtheora__info}{theora\+\_\+info} $\ast$ti)
\item 
int \hyperlink{group__oldfuncs_gac0d33d896ca70cedfc94c5986d947078}{theora\+\_\+encode\+\_\+\+Y\+U\+Vin} (\hyperlink{structtheora__state}{theora\+\_\+state} $\ast$t, \hyperlink{structyuv__buffer}{yuv\+\_\+buffer} $\ast$yuv)
\item 
int \hyperlink{group__oldfuncs_ga5f4929677a735bc2198c2309d235f1b3}{theora\+\_\+encode\+\_\+packetout} (\hyperlink{structtheora__state}{theora\+\_\+state} $\ast$t, int last\+\_\+p, \hyperlink{structogg__packet}{ogg\+\_\+packet} $\ast$op)
\item 
int \hyperlink{group__oldfuncs_ga451feb58d6bde726edbae193689887be}{theora\+\_\+encode\+\_\+header} (\hyperlink{structtheora__state}{theora\+\_\+state} $\ast$t, \hyperlink{structogg__packet}{ogg\+\_\+packet} $\ast$op)
\item 
int \hyperlink{group__oldfuncs_ga45e8db0713eaaca0f1144f3724cb834a}{theora\+\_\+encode\+\_\+comment} (\hyperlink{structtheora__comment}{theora\+\_\+comment} $\ast$tc, \hyperlink{structogg__packet}{ogg\+\_\+packet} $\ast$op)
\item 
int \hyperlink{group__oldfuncs_ga5085baf20855b283fa01fc948505d9d2}{theora\+\_\+encode\+\_\+tables} (\hyperlink{structtheora__state}{theora\+\_\+state} $\ast$t, \hyperlink{structogg__packet}{ogg\+\_\+packet} $\ast$op)
\item 
int \hyperlink{group__oldfuncs_ga02915e63c1bd733ee291f577a8b75a82}{theora\+\_\+decode\+\_\+header} (\hyperlink{structtheora__info}{theora\+\_\+info} $\ast$ci, \hyperlink{structtheora__comment}{theora\+\_\+comment} $\ast$cc, \hyperlink{structogg__packet}{ogg\+\_\+packet} $\ast$op)
\item 
int \hyperlink{group__oldfuncs_ga264907c66003799ff77ecbd09eb33d2c}{theora\+\_\+decode\+\_\+init} (\hyperlink{structtheora__state}{theora\+\_\+state} $\ast$th, \hyperlink{structtheora__info}{theora\+\_\+info} $\ast$c)
\item 
int \hyperlink{group__oldfuncs_gaa65a9e53b46fd54ab344bd599fa96975}{theora\+\_\+decode\+\_\+packetin} (\hyperlink{structtheora__state}{theora\+\_\+state} $\ast$th, \hyperlink{structogg__packet}{ogg\+\_\+packet} $\ast$op)
\item 
int \hyperlink{group__oldfuncs_ga09d47c80e1e94bff0a46a496816b8daa}{theora\+\_\+decode\+\_\+\+Y\+U\+Vout} (\hyperlink{structtheora__state}{theora\+\_\+state} $\ast$th, \hyperlink{structyuv__buffer}{yuv\+\_\+buffer} $\ast$yuv)
\item 
int \hyperlink{group__oldfuncs_gab969f9d0407683f0e5abe73d0839a25b}{theora\+\_\+packet\+\_\+isheader} (\hyperlink{structogg__packet}{ogg\+\_\+packet} $\ast$op)
\item 
int \hyperlink{group__oldfuncs_ga39ccc8f847a748d7074c926b4fdd12b2}{theora\+\_\+packet\+\_\+iskeyframe} (\hyperlink{structogg__packet}{ogg\+\_\+packet} $\ast$op)
\item 
int \hyperlink{group__oldfuncs_gacd9360e6a47139c761002410af457a02}{theora\+\_\+granule\+\_\+shift} (\hyperlink{structtheora__info}{theora\+\_\+info} $\ast$ti)
\item 
ogg\+\_\+int64\+\_\+t \hyperlink{group__oldfuncs_ga7bfa3ceb2fb4b41a282456c56e1dd269}{theora\+\_\+granule\+\_\+frame} (\hyperlink{structtheora__state}{theora\+\_\+state} $\ast$th, ogg\+\_\+int64\+\_\+t granulepos)
\item 
double \hyperlink{group__oldfuncs_ga4376358b12b9fa23ce6fe21cb5c65ac6}{theora\+\_\+granule\+\_\+time} (\hyperlink{structtheora__state}{theora\+\_\+state} $\ast$th, ogg\+\_\+int64\+\_\+t granulepos)
\item 
\hyperlink{png_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{group__oldfuncs_ga3091c87d48f1faba018c5956379a6d90}{theora\+\_\+info\+\_\+init} (\hyperlink{structtheora__info}{theora\+\_\+info} $\ast$c)
\item 
\hyperlink{png_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{group__oldfuncs_gaba7022d58edbc4825cacad03f68b3e0d}{theora\+\_\+info\+\_\+clear} (\hyperlink{structtheora__info}{theora\+\_\+info} $\ast$c)
\item 
\hyperlink{png_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{group__oldfuncs_gab252d5d81b925136dda72e8f1c09c5eb}{theora\+\_\+clear} (\hyperlink{structtheora__state}{theora\+\_\+state} $\ast$t)
\item 
\hyperlink{png_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{group__oldfuncs_ga811b92785df3bdbbebb3de612d9d6ce0}{theora\+\_\+comment\+\_\+init} (\hyperlink{structtheora__comment}{theora\+\_\+comment} $\ast$tc)
\item 
\hyperlink{png_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{group__oldfuncs_ga650642ed23894e41109bbc42ec393ed4}{theora\+\_\+comment\+\_\+add} (\hyperlink{structtheora__comment}{theora\+\_\+comment} $\ast$tc, char $\ast$comment)
\item 
\hyperlink{png_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{group__oldfuncs_ga339bd80b5bf4bb168b7052d8ec0b5a92}{theora\+\_\+comment\+\_\+add\+\_\+tag} (\hyperlink{structtheora__comment}{theora\+\_\+comment} $\ast$tc, char $\ast$tag, char $\ast$value)
\item 
char $\ast$ \hyperlink{group__oldfuncs_ga4361f6001abb5c83c36a2ddfb648a8dc}{theora\+\_\+comment\+\_\+query} (\hyperlink{structtheora__comment}{theora\+\_\+comment} $\ast$tc, char $\ast$tag, int \hyperlink{_core_8c_ad43c3812e6d13e0518d9f8b8f463ffcf}{count})
\item 
int \hyperlink{group__oldfuncs_ga10f66a3c752442a3e0c0098e0f88df8b}{theora\+\_\+comment\+\_\+query\+\_\+count} (\hyperlink{structtheora__comment}{theora\+\_\+comment} $\ast$tc, char $\ast$tag)
\item 
\hyperlink{png_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{group__oldfuncs_ga04c07c2eefba3a433e43f9fbde14719f}{theora\+\_\+comment\+\_\+clear} (\hyperlink{structtheora__comment}{theora\+\_\+comment} $\ast$tc)
\item 
int \hyperlink{group__oldfuncs_ga186773db3bc8cd550047e7df1b2ba2c9}{theora\+\_\+control} (\hyperlink{structtheora__state}{theora\+\_\+state} $\ast$th, int req, \hyperlink{png_8h_ac9c84fa68bbad002983e35ce3663c686}{void} $\ast$buf, size\+\_\+t buf\+\_\+sz)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
The libtheora pre-\/1.\+0 legacy C A\+PI.\hypertarget{theora_8h_intro}{}\subsection{Introduction}\label{theora_8h_intro}
This is the documentation for the libtheora legacy C A\+PI, declared in the \hyperlink{theora_8h}{theora.\+h} header, which describes the old interface used before the 1.\+0 release. This A\+PI was widely deployed for several years and remains supported, but for new code we recommend the cleaner A\+PI declared in \hyperlink{theoradec_8h}{theoradec.\+h} and theoraenc.\+h.

libtheora is the reference implementation for \href{http://www.theora.org/}{\tt Theora}, a free video codec. Theora is derived from On2\textquotesingle{}s V\+P3 codec with improved integration with Ogg multimedia formats by \href{http://www.xiph.org/}{\tt Xiph.\+Org}.\hypertarget{theora_8h_overview}{}\subsection{Overview}\label{theora_8h_overview}
This library will both decode and encode theora packets to/from raw Y\+UV frames. In either case, the packets will most likely either come from or need to be embedded in an Ogg stream. Use \href{http://xiph.org/ogg/}{\tt libogg} or \href{http://www.annodex.net/software/liboggz/index.html}{\tt liboggz} to extract/package these packets.\hypertarget{theora_8h_decoding}{}\subsection{Decoding Process}\label{theora_8h_decoding}
Decoding can be separated into the following steps\+:
\begin{DoxyEnumerate}
\item initialise \hyperlink{structtheora__info}{theora\+\_\+info} and \hyperlink{structtheora__comment}{theora\+\_\+comment} structures using \hyperlink{group__oldfuncs_ga3091c87d48f1faba018c5956379a6d90}{theora\+\_\+info\+\_\+init()} and \hyperlink{group__oldfuncs_ga811b92785df3bdbbebb3de612d9d6ce0}{theora\+\_\+comment\+\_\+init()}\+: \begin{DoxyVerb}theora_info     info;
theora_comment  comment;
  
theora_info_init(&info);
theora_comment_init(&comment);
\end{DoxyVerb}

\item retrieve header packets from Ogg stream (there should be 3) and decode into \hyperlink{structtheora__info}{theora\+\_\+info} and \hyperlink{structtheora__comment}{theora\+\_\+comment} structures using \hyperlink{group__oldfuncs_ga02915e63c1bd733ee291f577a8b75a82}{theora\+\_\+decode\+\_\+header()}. See \hyperlink{theora_8h_identification}{Identifying Theora Packets} for more information on identifying which packets are theora packets. \begin{DoxyVerb}int i;
for (i = 0; i < 3; i++)
{
  (get a theora packet "op" from the Ogg stream)
  theora_decode_header(&info, &comment, op);
}
\end{DoxyVerb}

\item initialise the decoder based on the information retrieved into the \hyperlink{structtheora__info}{theora\+\_\+info} struct by \hyperlink{group__oldfuncs_ga02915e63c1bd733ee291f577a8b75a82}{theora\+\_\+decode\+\_\+header()}. You will need a \hyperlink{structtheora__state}{theora\+\_\+state} struct. \begin{DoxyVerb}theora_state state;

theora_decode_init(&state, &info);
\end{DoxyVerb}

\item pass in packets and retrieve decoded frames! See the \hyperlink{structyuv__buffer}{yuv\+\_\+buffer} documentation for information on how to retrieve raw Y\+UV data. \begin{DoxyVerb}yuf_buffer buffer;
while (last packet was not e_o_s) {
  (get a theora packet "op" from the Ogg stream)
  theora_decode_packetin(&state, op);
  theora_decode_YUVout(&state, &buffer);
}
\end{DoxyVerb}

\end{DoxyEnumerate}\hypertarget{theora_8h_identification}{}\subsubsection{Identifying Theora Packets}\label{theora_8h_identification}
All streams inside an Ogg file have a unique serial\+\_\+no attached to the stream. Typically, you will want to
\begin{DoxyItemize}
\item retrieve the serial\+\_\+no for each b\+\_\+o\+\_\+s (beginning of stream) page encountered within the Ogg file;
\item test the first (only) packet on that page to determine if it is a theora packet;
\item once you have found a theora b\+\_\+o\+\_\+s page then use the retrieved serial\+\_\+no to identify future packets belonging to the same theora stream.
\end{DoxyItemize}

Note that you {\itshape cannot} use \hyperlink{group__oldfuncs_gab969f9d0407683f0e5abe73d0839a25b}{theora\+\_\+packet\+\_\+isheader()} to determine if a packet is a theora packet or not, as this function does not perform any checking beyond whether a header bit is present. Instead, use the \hyperlink{group__oldfuncs_ga02915e63c1bd733ee291f577a8b75a82}{theora\+\_\+decode\+\_\+header()} function and check the return value; or examine the header bytes at the beginning of the Ogg page. 